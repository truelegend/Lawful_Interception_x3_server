import socket
import binascii
import time
server_addr = ('127.0.0.1',20000)
client = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)

hdr1 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>1-12c-2-2-20386a</Correlation-id><PayloadType>RTP</PayloadType><PayloadLength>200</PayloadLength></hi3-uag>'''
ip1 = binascii.a2b_hex(b"450000c8000040003f1112600a0213780a02014a")
udp1 = binascii.a2b_hex(b"182c1ba600b4bce8")
rtp1 = binascii.a2b_hex(b"80080000000003c000007b47d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d5d555d5d5d5d5d5d5d5d5d555d5d5d5d5d55555d5d5d5d55555d5d5d5d55555d5d555d5d5555754d7d1d6d7d7d7d6d4565c5f51d4d0d3d0555f585d565656d1d8ded6d5d1d75651d4d0555f5850d0d9dfd6d5d5d55457515056d5d0dcd8d8d3515e52d4d1d5535e5f57d1d657535257d7d6565c50d6ddd65555d7d1d3dcd2d75456505d5c51")

body1 = ip1 + udp1 + rtp1

x31 = hdr1 + body1
for i in range(1000):
    client.sendto(x31,server_addr)
    time.sleep(0.002)

time.sleep(0.02)
#body2 = binascii.a2b_hex(b"450000c8013f40006f11df92dfd63f310a02014a641e271200b4000080084388067f97744cb7239ad5d55555d555555555d5d5d555d5d5d5d55555d5d55555d55555d5d5d555d55555d5d555d55555d555d55555d5d5d5d5d555d555d555d5d55555555555555555d5d555d555d5d55555d555d5d5d5555555d555555555d5d5d555d5d555d55555d555d555d5d5d5d5d5d55555555555d555d5d555d5d5d555d55555d55555d5d5d555d5d5d5d5555555d5d5d5d5d5d5d5d555d5555555d5d5d5d555555555d5d5")
#x3 = hdr + body2
#client.sendto(x3,server_addr)

hdr2 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>from-target</CallDirection><Correlation-id>1-12c-33-2-20386a</Correlation-id><PayloadType>RTP</PayloadType><PayloadLength>200</PayloadLength></hi3-uag>'''
x32 = hdr2 + body1
client.sendto(x32,server_addr)


time.sleep(0.02)

hdr3 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>1-12c-33-2-20386a</Correlation-id><PayloadType>RTP</PayloadType><PayloadLength>168</PayloadLength></hi3-uag>'''

ip_rtcp = binascii.a2b_hex(b"450000a81d3f00008011f4400a02014a0a021378")
udp_rtcp = binascii.a2b_hex(b"1ba7182d009493be")
rtcp = binascii.a2b_hex(b"81c8000c0000251ad545a258a7bc3c5b00004ec00000007c00004d8000007b47000000000000007b0000009f000000000000000081ca00150000251a011e7369703a31343430383731303034394031302e322e312e37343a35303631060e4c696e70686f6e652d332e352e32071d54686973206973206672656520736f667477617265202847504c29202100")

x3_rtcp = hdr3 + ip_rtcp + udp_rtcp + rtcp

client.sendto(x3_rtcp,server_addr)


time.sleep(0.02)
hdr4 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>1-12c-2-2-0386a</Correlation-id><PayloadType>RTP</PayloadType><PayloadLength>220</PayloadLength></hi3-uag>'''
ip_v6 = binascii.a2b_hex(b"6000000000b41140200218901001220b0000000000000032200218901001220b0000000000000032")
udp4= binascii.a2b_hex(b"1f6a1f6400b45c71")
rtp4 = binascii.a2b_hex(b"8000000000000320156d14cfffffffffffffffff7fff7fff7fffff7ffe7efe7efe7efefe7bdfdbe1ef6a5e4e4e4f4e636366e2f97c6e585a575c5c5e68555d5e596e635f605b5a585755575c585e60555c595956585f565b5c5653585a565b595b5f54525653595c615c6568565e55525e5c635d685d5663555a5c595e5b5d595a5d585f6661625b595a5b5859605d606460635c655f5b61595b5f5d605f635c595e5e65636262615f5c5e5e")

x3_rtp_ipv6 = hdr4 + ip_v6 + udp4 + rtp4
client.sendto(x3_rtp_ipv6,server_addr)

time.sleep(0.02)
# hdr_msrp = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>2-12c-2-2-0386a</Correlation-id><PayloadType>MSRP</PayloadType><PayloadLength>6</PayloadLength></hi3-uag>'''
# #ip4 = binascii.a2b_hex(b"6000000000b41140200218901001220b0000000000000032200218901001220b0000000000000032")
# #udp4= binascii.a2b_hex(b"1f6a1f6400b45c71")
# #rtp4 = binascii.a2b_hex(b"8000000000000320156d14cfffffffffffffffff7fff7fff7fffff7ffe7efe7efe7efefe7bdfdbe1ef6a5e4e4e4f4e636366e2f97c6e585a575c5c5e68555d5e596e635f605b5a585755575c585e60555c595956585f565b5c5653585a565b595b5f54525653595c615c6568565e55525e5c635d685d5663555a5c595e5b5d595a5d585f6661625b595a5b5859605d606460635c655f5b61595b5f5d605f635c595e5e65636262615f5c5e5e")
# msrp = b"abcdef"
# x3_msrp = hdr_msrp + msrp
# client.sendto(x3_msrp,server_addr)

# ipv4 msrp
data = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e323232353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031313a33383a34333c2f7374616d703e3c43616c6c446972656374696f6e3e66726f6d2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303032363c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3237353c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e4500011300000000450637300a021e480a020b6ac35507d100000000000000005010000046a000004d53525020656d7074792053454e440d0a546f2d506174683a206d7372703a2f2f31302e322e31312e3130363a323030312f6e303173303069317435464533323439352b373b7463700d0a46726f6d2d506174683a206d7372703a2f2f31302e322e33302e37323a35303030352f3131303033303b7463700d0a4d6573736167652d49443a20656d7074790d0a537563636573732d5265706f72743a206e6f0d0a4661696c7572652d5265706f72743a206e6f0d0a427974652d52616e67653a20312d302f300d0a436f6e74656e742d547970653a200d0a0d0a0d0a2d2d2d2d2d2d2d656d707479240d0a")
client.sendto(data,server_addr)
time.sleep(0.02)
data = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e323232353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031313a33383a34343c2f7374616d703e3c43616c6c446972656374696f6e3e746f2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303032363c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3633333c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e4500027900000000450635ca0a020b6a0a021e4807d1c355000000000000000050100000688300004d535250206e303173303069317435464533323439352b392053454e440d0a546f2d506174683a206d7372703a2f2f31302e322e33302e37323a35303030352f3131303033303b7463700d0a46726f6d2d506174683a206d7372703a2f2f31302e322e31312e3130363a323030312f6e303173303069317435464533323439352b373b7463700d0a4d6573736167652d49443a206d4d5347313935373734373833302b2b362b2b322b2b312b2b362b2b312b2b330d0a537563636573732d5265706f72743a206e6f0d0a4661696c7572652d5265706f72743a206e6f0d0a427974652d52616e67653a20312d3236392f3239310d0a436f6e74656e742d547970653a206170706c69636174696f6e2f696d2d6973636f6d706f73696e672b786d6c0d0a0d0a3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0d0a3c6973436f6d706f73696e6720786d6c6e733d2275726e3a696574663a706172616d733a786d6c3a6e733a696d2d6973636f6d706f73696e67220d0a786d6c6e733a7873693d22687474703a2f2f7777772e77332e6f72672f323030312f584d4c536368656d612d696e7374616e6365220d0a7873693a736368656d614c6f636174696f6e3d2275726e3a696574663a706172616d733a786d6c3a6e733a696d2d636f6d706f73696e67206973636f6d706f73696e672e787364223e0d0a3c73746174653e6163746976653c2f73746174653e0d0a3c2f6973436f6d706f73696e673e0d0a0d0a2d2d2d2d2d2d2d6e303173303069317435464533323439352b39240d0a")
client.sendto(data,server_addr)
time.sleep(0.02)
data = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e323232353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031313a33383a34373c2f7374616d703e3c43616c6c446972656374696f6e3e746f2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303032363c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3533363c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e45000218000000004506362b0a020b6a0a021e4807d1c355000000010000000050100000fe2400004d535250206e303173303069317435464533323439352b31302053454e440d0a546f2d506174683a206d7372703a2f2f31302e322e33302e37323a35303030352f3131303033303b7463700d0a46726f6d2d506174683a206d7372703a2f2f31302e322e31312e3130363a323030312f6e303173303069317435464533323439352b373b7463700d0a4d6573736167652d49443a206d736763616c6c65723132322b2b330d0a537563636573732d5265706f72743a207965730d0a4661696c7572652d5265706f72743a207965730d0a427974652d52616e67653a20312d3230352f3230350d0a436f6e74656e742d547970653a20746578742f706c61696e0d0a0d0a546865204d6176656e6972204368617267696e6720436f6c6c656374696f6e2046756e6374696f6e2028434346292069732061206b657920636f6d706f6e656e7420696e20616e206f66666c696e65206368617267696e67206172636869746563747572652e20546865204d6176656e6972204368617267696e6720436f6c6c656374696f6e2046756e6374696f6e2028434346292069732061206b657920636f6d706f6e656e7420696e20616e206f66666c696e65206368617267696e67206172636869746563747572652e0d0a2d2d2d2d2d2d2d6e303173303069317435464533323439352b3130240d0a")
client.sendto(data,server_addr)
time.sleep(0.02)
data = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e323232353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031313a33383a34373c2f7374616d703e3c43616c6c446972656374696f6e3e66726f6d2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303032363c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3230363c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e450000ce00000000450637750a021e480a020b6ac35507d1000000010000000050100000370000004d535250206e303173303069317435464533323439352b3130203230300d0a546f2d506174683a206d7372703a2f2f31302e322e31312e3130363a323030312f6e303173303069317435464533323439352b373b7463700d0a46726f6d2d506174683a206d7372703a2f2f31302e322e33302e37323a35303030352f3131303033303b7463700d0a2d2d2d2d2d2d2d6e303173303069317435464533323439352b3130240d0a")
client.sendto(data,server_addr)
time.sleep(0.02)
# ipv6 msrp
datav6 = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e333335353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031303a34343a33343c2f7374616d703e3c43616c6c446972656374696f6e3e66726f6d2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303036303c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3331383c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e6000000001160645fd01976a000000330000000000000820fd01976a000000330000000000002031c35507d10000000000000000501000005fb200004d53525020656d7074792053454e440d0a546f2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a323033315d3a323030312f6e303173303069317435464533313230312b32393b7463700d0a46726f6d2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a3832305d3a35303030352f3131303033303b7463700d0a4d6573736167652d49443a20656d7074790d0a537563636573732d5265706f72743a206e6f0d0a4661696c7572652d5265706f72743a206e6f0d0a427974652d52616e67653a20312d302f300d0a436f6e74656e742d547970653a200d0a0d0a0d0a2d2d2d2d2d2d2d656d707479240d0a")
client.sendto(datav6,server_addr)

datav6 = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e333335353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031303a34343a33353c2f7374616d703e3c43616c6c446972656374696f6e3e746f2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303036303c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3637383c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e60000000027e0645fd01976a000000330000000000002031fd01976a00000033000000000000082007d1c3550000000000000000501000004c8400004d535250206e303173303069317435464533313230312b33392053454e440d0a546f2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a3832305d3a35303030352f3131303033303b7463700d0a46726f6d2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a323033315d3a323030312f6e303173303069317435464533313230312b32393b7463700d0a4d6573736167652d49443a206d4d5347313935373734373833302b2b362b2b322b2b312b2b362b2b312b2b310d0a537563636573732d5265706f72743a206e6f0d0a4661696c7572652d5265706f72743a206e6f0d0a427974652d52616e67653a20312d3236392f3239310d0a436f6e74656e742d547970653a206170706c69636174696f6e2f696d2d6973636f6d706f73696e672b786d6c0d0a0d0a3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0d0a3c6973436f6d706f73696e6720786d6c6e733d2275726e3a696574663a706172616d733a786d6c3a6e733a696d2d6973636f6d706f73696e67220d0a786d6c6e733a7873693d22687474703a2f2f7777772e77332e6f72672f323030312f584d4c536368656d612d696e7374616e6365220d0a7873693a736368656d614c6f636174696f6e3d2275726e3a696574663a706172616d733a786d6c3a6e733a696d2d636f6d706f73696e67206973636f6d706f73696e672e787364223e0d0a3c73746174653e6163746976653c2f73746174653e0d0a3c2f6973436f6d706f73696e673e0d0a0d0a2d2d2d2d2d2d2d6e303173303069317435464533313230312b3339240d0a")
client.sendto(datav6,server_addr)

datav6 = binascii.a2b_hex(b"3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d2249534f2d383835392d3122207374616e64616c6f6e653d226e6f223f3e3c21444f4354595045206869332d7561672053595354454d20226869332d7561672e647464223e3c6869332d7561673e3c6c692d7469643e333335353c2f6c692d7469643e3c7374616d703e323032302d31322d32332031303a34343a33383c2f7374616d703e3c43616c6c446972656374696f6e3e746f2d7461726765743c2f43616c6c446972656374696f6e3e3c436f7272656c6174696f6e2d69643e66662d3263372d33666666666666662d30303036303c2f436f7272656c6174696f6e2d69643e3c5061796c6f6164547970653e4d5352503c2f5061796c6f6164547970653e3c5061796c6f61644c656e6774683e3537393c2f5061796c6f61644c656e6774683e3c2f6869332d7561673e60000000021b0645fd01976a000000330000000000002031fd01976a00000033000000000000082007d1c355000000010000000050100000511900004d535250206e303173303069317435464533313230312b34302053454e440d0a546f2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a3832305d3a35303030352f3131303033303b7463700d0a46726f6d2d506174683a206d7372703a2f2f5b666430313a393736613a303a33333a3a323033315d3a323030312f6e303173303069317435464533313230312b32393b7463700d0a4d6573736167652d49443a206d736763616c6c65723132322b2b310d0a537563636573732d5265706f72743a207965730d0a4661696c7572652d5265706f72743a207965730d0a427974652d52616e67653a20312d3230352f3230350d0a436f6e74656e742d547970653a20746578742f706c61696e0d0a0d0a546865204d6176656e6972204368617267696e6720436f6c6c656374696f6e2046756e6374696f6e2028434346292069732061206b657920636f6d706f6e656e7420696e20616e206f66666c696e65206368617267696e67206172636869746563747572652e20546865204d6176656e6972204368617267696e6720436f6c6c656374696f6e2046756e6374696f6e2028434346292069732061206b657920636f6d706f6e656e7420696e20616e206f66666c696e65206368617267696e67206172636869746563747572652e0d0a2d2d2d2d2d2d2d6e303173303069317435464533313230312b3430240d0a")
client.sendto(datav6,server_addr)

## self build
#hdr_x3 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>31</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>2-12c-2-2-0386a</Correlation-id><PayloadType>MSRP</PayloadType><PayloadLength>311</PayloadLength></hi3-uag>'''
#ip4 = binascii.a2b_hex(b"45000137371f40003f06c3620a020df10a021e4b")
#tcp = binascii.a2b_hex(b"096dea613f8c0440de2a703b801800d570ca00000101080a493c332371fc7348")
#
#msrp = binascii.a2b_hex(b"4d535250206e303173303069317435464433423734372b302053454e440d0a546f2d506174683a206d7372703a2f2f31302e322e33302e37353a36303030312f36303030312b313b7463700d0a46726f6d2d506174683a206d7372703a2f2f31302e322e31332e3234313a323430312f6e303173303069317435464433423734372b31303b7463700d0a4d6573736167652d49443a206e303173303069317435464433423734372b300d0a537563636573732d5265706f72743a206e6f0d0a4661696c7572652d5265706f72743a206e6f0d0a427974652d52616e67653a20312d302f300d0a2d2d2d2d2d2d2d6e303173303069317435464433423734372b30240d0a")
#client.sendto(hdr_x3+ip4+tcp+msrp,server_addr)
#
## self build2
#hdr_x32 = b'''<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?><!DOCTYPE hi3-uag SYSTEM "hi3-uag.dtd"><hi3-uag><li-tid>37rdue77</li-tid><stamp>2016-04-27 04:08:45</stamp><CallDirection>to-target</CallDirection><Correlation-id>2-12c3-2-2-0386a</Correlation-id><PayloadType>MSRP</PayloadType><PayloadLength>217</PayloadLength></hi3-uag>'''
#ip42 = binascii.a2b_hex(b"450000d967e140008006b070c0a80383480ed593")
#tcp2 = binascii.a2b_hex(b"cbb801bb18d9b479eeba09dc5018403d47c10000")
#
#msrp2 = binascii.a2b_hex(b"16030100ac010000a803014d3f14befd17e1cbcd1751d1f8addd8ed140c8f75caaf8e07cd3ba872d3892b3000048c00ac0140088008700390038c00fc00500840035c007c009c011c01300450044006600330032c00cc00ec002c0040096004100040005002fc008c01200160013c00dc003feff000a020100003600000013001100000e7777772e676f6f676c652e636f6dff01000100000a00080006001700180019000b000201000023000033740000")
#client.sendto(hdr_x32+ip42+tcp2+msrp2,server_addr)

client.close()
